\[data-colorid=km8p5m5aip\]{color:#bf2600} html\[data-color-mode=dark\] \[data-colorid=km8p5m5aip\]{color:#ff6640}Once understood the basic concepts of WebFlux Reactor explained in [Reactive Programming with WebFlux Reactor (part I)](https://mirada.atlassian.net/wiki/spaces/BAC/pages/3302850669), it is good idea to read [Reactive Code Primer](https://mirada.atlassian.net/wiki/spaces/TECH/pages/1963131032/Reactive+Code+Primer) , which gives a lot of extra useful information.

In order to get the most of Spring WebFlux, it is important to use the reactive I/O components properly.

As explained in [Reactive Programming with WebFlux Reactor (part I)](https://mirada.atlassian.net/wiki/spaces/BAC/pages/3302850669), the following components are included in Spring WebFlux out of the box to be used by developers:

Web Client
----------

### GET

#### Response content is retrieved using a flow → Use FLUX

To be used when:

*   when the response is well structured as Json as array and the number of entities is long →bespoke components
    

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro1568452511528420012", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=057c3493-b8a2-4ca9-909e-84df47535876&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro1568452511528420012&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"057c3493-b8a2-4ca9-909e-84df47535876\\",\\"id\\":\\"057c3493-b8a2-4ca9-909e-84df47535876\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"057c3493-b8a2-4ca9-909e-84df47535876\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"ce543721-e1f8-4742-8a1e-2f0e2b086e39\\",\\"language\\":\\"java\\",\\"macro.body\\":\\"Flux\\u003cEmployee\\u003e employeeFlux = client.get()\\\\n .uri(\\\\\\"/employees\\\\\\")\\\\n .retrieve()\\\\n .bodyToFlux(Employee.class);\\\\n \\\\nemployeeFl\\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"057c3493-b8a2-4ca9-909e-84df47535876\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

#### Response content is retrieved in “one shot” → Use MONO

To be used when:

*   when the response is not well structured as Json array → example: Solr HTTP Response, Mirada APIs
    
*   when the response size is “short”: Even having a structured response, perhaps it is not worthy to use Flux
    

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro5634878336223955539", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=aa50ec04-1867-4c83-9df8-4c962e76cc15&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro5634878336223955539&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"aa50ec04-1867-4c83-9df8-4c962e76cc15\\",\\"id\\":\\"aa50ec04-1867-4c83-9df8-4c962e76cc15\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"aa50ec04-1867-4c83-9df8-4c962e76cc15\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"69d22c72-e547-4e0c-8f43-1676bae990de\\",\\"language\\":\\"java\\",\\"macro.body\\":\\"WebClient client = WebClient.create(\\\\\\"http://localhost:8080\\\\\\");\\\\n\\\\nMono\\u003cEmployee\\u003e employeeMono = client.get().uri(\\\\\\"/employees/{id}\\\\\\",\\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"aa50ec04-1867-4c83-9df8-4c962e76cc15\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

[http://dev.mirada.tv/hg/capability-iris-sdp-search/file/4aa31e59b83c/service-iris-sdp-search/src/main/java/tv/mirada/iris/sdp/search/service/HttpService.java](http://dev.mirada.tv/hg/capability-iris-sdp-search/file/4aa31e59b83c/service-iris-sdp-search/src/main/java/tv/mirada/iris/sdp/search/service/HttpService.java)

Fully working example including:

*   POST / GET Methods, passing parameters and headers
    
*   Logging response as string (if required)
    
*   Dealing with status code → generate exceptions if required
    
*   Dealing correctly with unexpected situations → timeouts
    

RestController
--------------

Similar to the conventional spring web controller, but methods should return Mono or Flux

Real example

[http://dev.mirada.tv/hg/capability-iris-sdp-search/file/4aa31e59b83c/service-iris-sdp-search/src/main/java/tv/mirada/iris/sdp/search/rest/SearchController.java](http://dev.mirada.tv/hg/capability-iris-sdp-search/file/4aa31e59b83c/service-iris-sdp-search/src/main/java/tv/mirada/iris/sdp/search/rest/SearchController.java)

Fully working example including:

*   Swagger public documentation
    
*   Using a **builder** to handle request params → important to have clean code!!!
    
*   single responsability → controller handles only I/O parameters → all business logic is delegated to the proper service
    

Redis
-----

based on templates, similar to the non reactive API

org.springframework.data.redis.core.ReactiveRedisTemplate

Basic operations (get / set) → use opsForValue()

#### SET VALUE

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro4187150529478433258", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=cd6f8c49-ad70-408a-84f8-43d70f3d1f11&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro4187150529478433258&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"cd6f8c49-ad70-408a-84f8-43d70f3d1f11\\",\\"id\\":\\"cd6f8c49-ad70-408a-84f8-43d70f3d1f11\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"cd6f8c49-ad70-408a-84f8-43d70f3d1f11\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"78528e9b-b817-400c-aa1e-f16ebfc3be35\\",\\"language\\":\\"java\\",\\"macro.body\\":\\" public Mono\\u003cQueryResult\\u003e assignIdAndcacheQueryResultIfNotEmpty(QueryResult queryResult) {\\\\n if (queryResult.isEmpty())\\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"cd6f8c49-ad70-408a-84f8-43d70f3d1f11\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

#### GET VALUE

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro8212232378829556557", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=977da86d-7f27-4938-9ad8-95a7122dc326&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro8212232378829556557&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"977da86d-7f27-4938-9ad8-95a7122dc326\\",\\"id\\":\\"977da86d-7f27-4938-9ad8-95a7122dc326\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"977da86d-7f27-4938-9ad8-95a7122dc326\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"6eb5b5b4-b042-4609-b0bd-91cdd71edb45\\",\\"language\\":\\"java\\",\\"macro.body\\":\\" public Mono\\u003cQueryResult\\u003e getQueryResult(String id) {\\\\n \\\\n return pageRedisTemplate.opsForValue().get(id)\\\\n \\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"977da86d-7f27-4938-9ad8-95a7122dc326\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

There are multidata version which are very useful:

#### SET MAP KEY - VALUE

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro857531215613371282", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=21723c5f-725a-48cb-8378-f31e0f322059&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro857531215613371282&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"21723c5f-725a-48cb-8378-f31e0f322059\\",\\"id\\":\\"21723c5f-725a-48cb-8378-f31e0f322059\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"21723c5f-725a-48cb-8378-f31e0f322059\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"1d66cae4-99b4-4ba2-ba08-ddce527f3384\\",\\"language\\":\\"java\\",\\"macro.body\\":\\"public Mono\\u003cBoolean\\u003e put(Map\\u003cString, SegmenterCustomer\\u003e segmenterCustomerMap) {\\\\n \\\\n Map\\u003cString, SegmenterCustomer\\u003e \\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"21723c5f-725a-48cb-8378-f31e0f322059\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

#### DELETE one or more keys

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro1230204103477370537", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=e22b0573-b06d-4f33-a4ea-bd759e7c480c&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro1230204103477370537&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"e22b0573-b06d-4f33-a4ea-bd759e7c480c\\",\\"id\\":\\"e22b0573-b06d-4f33-a4ea-bd759e7c480c\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"e22b0573-b06d-4f33-a4ea-bd759e7c480c\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"9be8f33d-4799-427a-9eae-2ae34e4ae52e\\",\\"language\\":\\"java\\",\\"macro.body\\":\\"String\[\] keysToDelete = keysToDeleteList.stream().toArray(String\[\]::new);\\\\nMono\\u003cLong\\u003e monoDeletedElemens = redisTemplate.delete(k\\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"e22b0573-b06d-4f33-a4ea-bd759e7c480c\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

**Database**
------------

*   At the moment there is not a fully working implementation of a Reactive driver for Oracle database (11g)
    
*   Project Oracle R2DBC: [https://github.com/oracle/oracle-r2dbc](https://github.com/oracle/oracle-r2dbc) → _The Oracle R2DBC Driver has been verified with Oracle Database versions 19c and 21c._
    
*   Dave Moten wrote a driver: [https://github.com/davidmoten/rxjava2-jdbc](https://github.com/davidmoten/rxjava2-jdbc)
    
    *   Originally written in RxJava, not Reactor, however it is fully integrated in Reactor
        
    *   Used in some projects of Mirada
        

Example:

//<!\[CDATA\[ (function(){ var data = { "addon\_key":"com.atlassian.connect.better-code-macro.prod", "uniqueKey":"com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro415866955427842964", "key":"paste-code-macro", "moduleType":"dynamicContentMacros", "moduleLocation":"content", "cp":"/wiki", "general":"", "w":"", "h":"", "url":"https://cloud-code-macro.services.atlassian.com/macro/paste-code-macro?page\_id=4605477031&macro\_id=733b10c3-ce9e-48d6-96df-8ae74a41322a&page\_version=1&output\_type=html\_export&theme=&language=java&title=&xdm\_e=https%3A%2F%2Fmirada.atlassian.net&xdm\_c=channel-com.atlassian.connect.better-code-macro.prod\_\_paste-code-macro415866955427842964&cp=%2Fwiki&xdm\_deprecated\_addon\_key\_do\_not\_use=com.atlassian.connect.better-code-macro.prod&lic=none&cv=1000.0.0-ed9338f6a197", "structuredContext": "{\\"confluence\\":{\\"editor\\":{\\"version\\":\\"\\\\\\"v2\\\\\\"\\"},\\"macro\\":{\\"outputType\\":\\"html\_export\\",\\"hash\\":\\"733b10c3-ce9e-48d6-96df-8ae74a41322a\\",\\"id\\":\\"733b10c3-ce9e-48d6-96df-8ae74a41322a\\"},\\"content\\":{\\"type\\":\\"page\\",\\"version\\":\\"1\\",\\"id\\":\\"4605477031\\"},\\"space\\":{\\"key\\":\\"~117741573\\",\\"id\\":\\"1352302837\\"}}}", "contentClassifier":"content", "productCtx":"{\\"page.id\\":\\"4605477031\\",\\"macro.hash\\":\\"733b10c3-ce9e-48d6-96df-8ae74a41322a\\",\\"space.key\\":\\"~117741573\\",\\"page.type\\":\\"page\\",\\"content.version\\":\\"1\\",\\"page.title\\":\\"Copy of Reactive Programming with WebFlux Reactor (part II)\\",\\"macro.localId\\":\\"a041b479-1c8f-4b54-ab78-52f913282dee\\",\\"language\\":\\"java\\",\\"macro.body\\":\\"\\\\tpublic Flux\\u003cVoucher\\u003e getVouchers(String idVoucher) {\\\\n String query = SELECT\_ACTIVE\_VOUCHERS ;\\\\n\\\\n return Flux.f\\",\\": = | RAW | = :\\":\\"language=java\\",\\"space.id\\":\\"1352302837\\",\\"macro.truncated\\":\\"true\\",\\"content.type\\":\\"page\\",\\"output.type\\":\\"html\_export\\",\\"page.version\\":\\"1\\",\\"content.id\\":\\"4605477031\\",\\"macro.id\\":\\"733b10c3-ce9e-48d6-96df-8ae74a41322a\\",\\"user.isExternalCollaborator\\":\\"false\\",\\"editor.version\\":\\"\\\\\\"v2\\\\\\"\\"}", "timeZone":"UTC", "origin":"https://cloud-code-macro.services.atlassian.com", "hostOrigin":"https://mirada.atlassian.net", "sandbox":"allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-storage-access-by-user-activation", "apiMigrations": { "gdpr": true } } ; if(window.AP && window.AP.subCreate) { window.\_AP.appendConnectAddon(data); } else { require(\['ac/create'\], function(create){ create.appendConnectAddon(data); }); } // For Confluence App Analytics. This code works in conjunction with CFE's ConnectSupport.js. // Here, we add a listener to the initial HTML page that stores events if the ConnectSupport component // has not mounted yet. In CFE, we process the missed event data and disable this initial listener. const \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_ = 20; const connectAppAnalytics = "ecosystem.confluence.connect.analytics"; window.connectHost && window.connectHost.onIframeEstablished((eventData) => { if (!window.\_\_CONFLUENCE\_CONNECT\_SUPPORT\_LOADED\_\_) { let events = JSON.parse(window.localStorage.getItem(connectAppAnalytics)) || \[\]; if (events.length >= \_\_MAX\_EVENT\_ARRAY\_SIZE\_\_) { events.shift(); } events.push(eventData); window.localStorage.setItem(connectAppAnalytics, JSON.stringify(events)); } }); }()); //\]\]>

Database is a bean of **org.davidmoten.rx.jdbc.Database** that is typically configured as pointed in:

[http://dev.mirada.tv/hg/capability-iris-sdp-wishlist/file/10846da72bad/service-iris-sdp-wishlist/src/main/java/tv/mirada/iris/sdp/wishlist/port/rx2jdbc/RXJdbcConfiguration.java](http://dev.mirada.tv/hg/capability-iris-sdp-wishlist/file/10846da72bad/service-iris-sdp-wishlist/src/main/java/tv/mirada/iris/sdp/wishlist/port/rx2jdbc/RXJdbcConfiguration.java)

Known issues

**DO NOT USE block() on a MONO returned by the driver, if so, it will “kept” the executing thread indefinitely and the service will soon collapse**

MQTT
----

HiveMQ MQTT Client Reactor Module???

Document generated by Confluence on Jan 13, 2024 06:48

[Atlassian](http://www.atlassian.com/)